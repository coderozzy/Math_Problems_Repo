<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Axiomatic Probability Theory - Kolmogorov Lab</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .math { font-family: "Times New Roman", Times, serif; font-style: italic; }
        .math-b { font-family: "Times New Roman", Times, serif; font-weight: bold; font-style: normal; }
        
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        
        .omega-tile {
            transition: all 0.2s ease;
            cursor: pointer;
        }
        .omega-tile.selected {
            background-color: #4f46e5;
            color: white;
            border-color: #4338ca;
            transform: scale(1.05);
        }

        .mode-btn.active {
            background-color: #1e293b;
            color: white;
        }

        .tab-btn.active {
            background-color: white;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
            color: #4f46e5;
        }

        input[type=range] {
            width: 100%;
            cursor: pointer;
        }

        .axiom-item {
            border-left: 3px solid #e2e8f0;
            padding-left: 1rem;
            margin-bottom: 1rem;
        }
        .axiom-item.valid {
            border-left-color: #6366f1;
        }
    </style>
</head>
<body class="bg-white text-slate-900 min-h-screen font-sans">

    <div class="max-w-6xl mx-auto p-4 md:p-8">
        <!-- GLOBAL MODE SELECTOR -->
        <header class="mb-8 flex flex-col md:flex-row md:items-center justify-between gap-6 border-b pb-6">
            <div>
                <h1 class="text-3xl font-extrabold text-slate-800">Probability Laboratory</h1>
                <p class="text-slate-500 italic">Formalism of ( &Omega;, F, P )</p>
            </div>
            
            <div class="flex bg-slate-100 p-1 rounded-xl shadow-inner border border-slate-200">
                <button onclick="setMode('discrete')" id="mode-discrete" class="mode-btn active px-6 py-2 rounded-lg text-sm font-bold transition-all">
                    Discrete Space
                </button>
                <button onclick="setMode('continuous')" id="mode-continuous" class="mode-btn px-6 py-2 rounded-lg text-sm font-bold transition-all">
                    Continuous Space
                </button>
            </div>
        </header>

        <!-- THREE-TAB NAVIGATION -->
        <nav class="flex space-x-1 bg-slate-100 p-1 rounded-xl mb-8 border border-slate-200">
            <button onclick="showTab('omega')" id="tab-btn-omega" class="tab-btn active flex-1 py-2 px-4 rounded-lg text-sm font-medium transition-all">
                1. Sample Space (&Omega;)
            </button>
            <button onclick="showTab('sigma')" id="tab-btn-sigma" class="tab-btn flex-1 py-2 px-4 rounded-lg text-sm font-medium transition-all">
                2. Sigma-algebra (F)
            </button>
            <button onclick="showTab('measure')" id="tab-btn-measure" class="tab-btn flex-1 py-2 px-4 rounded-lg text-sm font-medium transition-all">
                3. Measure (P)
            </button>
        </nav>

        <!-- TAB 1: SAMPLE SPACE -->
        <div id="content-omega" class="tab-content active space-y-6">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="p-6">
                    <h2 class="text-2xl font-bold mb-4">Sample Space (&Omega;)</h2>
                    <p class="text-slate-600 mb-6 leading-relaxed">
                        The <span class="math">&Omega;</span> is the set of all possible outcomes. In our mathematical framework, it must be clearly defined before we can build any event structures.
                    </p>
                    <div id="omega-definition" class="p-6 bg-slate-50 rounded-2xl border border-slate-200 font-serif italic text-lg text-slate-800">
                        <!-- Dynamic text -->
                    </div>
                </div>
                <div class="bg-slate-50 border border-slate-200 rounded-3xl p-8 flex items-center justify-center">
                    <div id="omega-visual" class="w-full">
                        <!-- Dynamic visual -->
                    </div>
                </div>
            </div>
        </div>

        <!-- TAB 2: SIGMA-ALGEBRA -->
        <div id="content-sigma" class="tab-content space-y-6">
            <div class="bg-white p-6 rounded-2xl border border-slate-200 shadow-sm">
                <h2 class="text-2xl font-bold mb-6">Axioms of Sigma-algebra (<span class="math-b">F</span>)</h2>
                <p class="text-slate-600 mb-8">
                    A family of subsets <span class="math-b">F</span> is a &sigma;-algebra on <span class="math">&Omega;</span> if it satisfies the following properties:
                </p>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="axiom-item valid">
                        <h4 class="font-bold text-indigo-600 text-sm uppercase">I. Non-emptiness</h4>
                        <p class="math-b text-lg">&Omega; &isin; F</p>
                        <p class="text-xs text-slate-500 mt-2">The whole space is a measurable event.</p>
                    </div>
                    <div class="axiom-item valid">
                        <h4 class="font-bold text-indigo-600 text-sm uppercase">II. Complement</h4>
                        <p class="math-b text-lg">A &isin; F &rArr; A<sup>c</sup> &isin; F</p>
                        <p class="text-xs text-slate-500 mt-2">If an event can occur, its non-occurrence is also measurable.</p>
                    </div>
                    <div class="axiom-item valid">
                        <h4 class="font-bold text-indigo-600 text-sm uppercase">III. Countable Union</h4>
                        <p class="math-b text-lg">&cup; A<sub>i</sub> &isin; F</p>
                        <p class="text-xs text-slate-500 mt-2">The union of any countable sequence of events is measurable.</p>
                    </div>
                </div>

                <div id="borel-explanation" class="mt-8 p-6 bg-blue-50 rounded-xl border border-blue-100 hidden">
                    <h4 class="font-bold text-blue-800 mb-2">Borel Sigma-algebra B(&real;)</h4>
                    <p class="text-sm text-blue-700 leading-relaxed">
                        In continuous spaces, we cannot assign non-zero probability to all subsets. We use the Borel &sigma;-algebra, generated by all open intervals (a, b). It contains points, open/closed intervals, and their countable combinations.
                    </p>
                </div>
            </div>
        </div>

        <!-- TAB 3: MEASURE -->
        <div id="content-measure" class="tab-content space-y-6">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Event Selection Tools -->
                <div class="lg:col-span-1 space-y-6">
                    <div class="bg-white p-6 rounded-2xl border border-slate-200 shadow-sm">
                        <h3 class="font-bold text-slate-800 mb-4">Define Event <span class="math">A</span></h3>
                        <div id="measure-controls" class="space-y-4">
                            <!-- Dynamic Inputs -->
                        </div>
                    </div>

                    <div id="measure-axioms" class="bg-white p-6 rounded-2xl border border-slate-200 shadow-sm">
                        <h3 class="font-bold text-slate-800 mb-4">Axioms of Measure (<span class="math">P</span>)</h3>
                        <div class="space-y-3 text-xs">
                            <p><span class="math-b">P(A) &ge; 0</span> (Non-negativity)</p>
                            <p><span class="math-b">P(&Omega;) = 1</span> (Normalization)</p>
                            <p><span class="math-b">P(&cup; A<sub>i</sub>) = &Sigma; P(A<sub>i</sub>)</span> (Countable Additivity)</p>
                        </div>
                    </div>
                </div>

                <!-- Main Visualization -->
                <div class="lg:col-span-2">
                    <div class="bg-white p-8 rounded-2xl border border-slate-200 shadow-sm flex flex-col items-center">
                        <div class="w-full flex justify-between items-start mb-8">
                            <div>
                                <h3 id="measure-title" class="text-xl font-bold">Probability Measure</h3>
                                <div id="event-set-display" class="font-mono text-indigo-600 mt-1"></div>
                            </div>
                            <div class="text-right">
                                <div id="p-result" class="text-6xl font-serif font-bold text-indigo-600 italic">0.00</div>
                                <div id="p-formula" class="text-xs font-mono text-slate-400 mt-1"></div>
                            </div>
                        </div>

                        <div id="measure-chart-container" class="w-full min-h-[250px] flex items-center justify-center">
                            <!-- SVG or Bar Chart -->
                        </div>

                        <div id="math-insights" class="mt-8 w-full p-4 bg-slate-50 rounded-xl border border-slate-100">
                            <!-- Mathematical insights like P({x}) = 0 -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <footer class="mt-12 text-center text-slate-400 text-xs">
            &copy; 2024 Axiomatic Probability Laboratory &bull; Kolmogorov Framework
        </footer>
    </div>

    <script>
        // --- STATE ---
        let currentMode = 'discrete';
        let currentTab = 'omega';
        
        let selectedOutcomes = new Set();
        let intervalA = -1.0;
        let intervalB = 1.0;
        let intervalType = 'closed'; // 'closed', 'open', 'point'

        // --- NAVIGATION ---
        function setMode(mode) {
            currentMode = mode;
            document.getElementById('mode-discrete').classList.toggle('active', mode === 'discrete');
            document.getElementById('mode-continuous').classList.toggle('active', mode === 'continuous');
            document.getElementById('borel-explanation').classList.toggle('hidden', mode === 'discrete');
            
            selectedOutcomes.clear();
            intervalA = -1.0;
            intervalB = 1.0;
            intervalType = 'closed';
            
            refreshUI();
        }

        function showTab(tabId) {
            currentTab = tabId;
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            
            document.getElementById(`content-${tabId}`).classList.add('active');
            document.getElementById(`tab-btn-${tabId}`).classList.add('active');
            
            refreshUI();
        }

        // --- UI REFRESH ---
        function refreshUI() {
            updateOmegaTab();
            updateSigmaTab();
            updateMeasureTab();
        }

        function updateOmegaTab() {
            const desc = document.getElementById('omega-definition');
            const visual = document.getElementById('omega-visual');
            
            if (currentMode === 'discrete') {
                desc.innerHTML = "&Omega; = { &omega;<sub>1</sub>, &omega;<sub>2</sub>, &omega;<sub>3</sub>, &omega;<sub>4</sub>, &omega;<sub>5</sub>, &omega;<sub>6</sub> } <br><small class='text-slate-400'>Finite set of discrete outcomes.</small>";
                visual.innerHTML = `
                    <div class="grid grid-cols-3 gap-6">
                        ${[1,2,3,4,5,6].map(i => `<div class="aspect-square bg-white border border-slate-200 text-slate-800 rounded-2xl flex items-center justify-center font-bold text-2xl shadow-sm">&omega;<sub>${i}</sub></div>`).join('')}
                    </div>
                `;
            } else {
                desc.innerHTML = "&Omega; = &real; <br><small class='text-slate-400'>The set of all Real Numbers.</small>";
                visual.innerHTML = `
                    <div class="relative h-12 w-full flex items-center px-4">
                        <div class="h-0.5 bg-slate-300 w-full relative">
                            <div class="absolute left-0 -top-2 text-[10px]">-&infin;</div>
                            <div class="absolute right-0 -top-2 text-[10px]">+&infin;</div>
                            <div class="absolute left-1/2 -top-2 w-px h-4 bg-slate-800"></div>
                            <div class="absolute left-1/2 top-4 -translate-x-1/2 text-xs font-bold text-slate-800">0</div>
                        </div>
                    </div>
                    <p class="text-center text-xs text-slate-400 mt-4">Continuous number line where every point is an outcome.</p>
                `;
            }
        }

        function updateSigmaTab() {
            // Primarily text-based axiom explanation, handled by HTML
        }

        function updateMeasureTab() {
            const controls = document.getElementById('measure-controls');
            const chart = document.getElementById('measure-chart-container');
            const result = document.getElementById('p-result');
            const formula = document.getElementById('p-formula');
            const setDisplay = document.getElementById('event-set-display');
            const insights = document.getElementById('math-insights');

            if (currentMode === 'discrete') {
                controls.innerHTML = `
                    <div class="grid grid-cols-3 gap-2">
                        ${[1,2,3,4,5,6].map(i => `
                            <button onclick="toggleDiscrete(${i})" class="omega-tile aspect-square border-2 ${selectedOutcomes.has(i) ? 'bg-indigo-600 border-indigo-700 text-white shadow-lg' : 'bg-white border-slate-100 text-slate-400'} rounded-lg flex items-center justify-center font-bold text-xs italic">
                                &omega;${i}
                            </button>
                        `).join('')}
                    </div>
                    <div class="flex gap-2 mt-4">
                        <button onclick="setDiscretePreset('even')" class="flex-1 text-[10px] font-bold py-2 bg-slate-100 rounded-lg hover:bg-slate-200">EVEN</button>
                        <button onclick="setDiscretePreset('prime')" class="flex-1 text-[10px] font-bold py-2 bg-slate-100 rounded-lg hover:bg-slate-200">PRIME</button>
                    </div>
                `;

                const arr = Array.from(selectedOutcomes).sort();
                const prob = arr.length / 6;
                setDisplay.textContent = arr.length ? `A = { ${arr.map(x => `ω${x}`).join(', ')} }` : 'A = ∅';
                result.textContent = prob.toFixed(2);
                formula.textContent = `P(A) = Σ P(ωi) = ${arr.length}/6`;
                
                chart.innerHTML = `
                    <div class="flex items-end gap-2 h-40 w-full px-4">
                        ${[1,2,3,4,5,6].map(i => `
                            <div class="flex-1 flex flex-col items-center">
                                <div class="w-full bg-indigo-500 rounded-t-sm transition-all duration-300" style="height: ${selectedOutcomes.has(i) ? 100 : 0}%"></div>
                                <span class="text-[10px] mt-2 text-slate-400 italic">ω${i}</span>
                            </div>
                        `).join('')}
                    </div>
                `;
                insights.innerHTML = `<p class="text-sm">In discrete spaces, <strong>Sigma-additivity</strong> means we just sum probabilities of individual outcomes in A.</p>`;

            } else {
                controls.innerHTML = `
                    <div class="space-y-6">
                        <div class="flex bg-slate-100 p-1 rounded-lg">
                            <button onclick="setIntervalType('closed')" class="flex-1 py-1 text-[10px] font-bold rounded ${intervalType==='closed'?'bg-white shadow-sm':''}">[ a, b ]</button>
                            <button onclick="setIntervalType('open')" class="flex-1 py-1 text-[10px] font-bold rounded ${intervalType==='open'?'bg-white shadow-sm':''}"> ( a, b ) </button>
                            <button onclick="setIntervalType('point')" class="flex-1 py-1 text-[10px] font-bold rounded ${intervalType==='point'?'bg-white shadow-sm':''}"> Point {x} </button>
                        </div>
                        ${intervalType !== 'point' ? `
                            <div>
                                <label class="text-[10px] font-bold uppercase text-slate-400 block mb-1">Lower Bound (a): ${intervalA.toFixed(2)}</label>
                                <input type="range" min="-4" max="4" step="0.01" value="${intervalA}" oninput="setInterval('a', this.value)">
                            </div>
                            <div>
                                <label class="text-[10px] font-bold uppercase text-slate-400 block mb-1">Upper Bound (b): ${intervalB.toFixed(2)}</label>
                                <input type="range" min="-4" max="4" step="0.01" value="${intervalB}" oninput="setInterval('b', this.value)">
                            </div>
                        ` : `
                            <div>
                                <label class="text-[10px] font-bold uppercase text-slate-400 block mb-1">Value (x): ${intervalA.toFixed(2)}</label>
                                <input type="range" min="-4" max="4" step="0.01" value="${intervalA}" oninput="setInterval('p', this.value)">
                            </div>
                        `}
                    </div>
                `;

                const start = intervalType === 'point' ? intervalA : Math.min(intervalA, intervalB);
                const end = intervalType === 'point' ? intervalA : Math.max(intervalA, intervalB);
                const prob = intervalType === 'point' ? 0 : gaussianCDF(end) - gaussianCDF(start);

                setDisplay.textContent = intervalType === 'closed' ? `A = [ ${start.toFixed(2)}, ${end.toFixed(2)} ]` : 
                                         intervalType === 'open' ? `A = ( ${start.toFixed(2)}, ${end.toFixed(2)} )` :
                                         `A = { ${start.toFixed(2)} }`;

                result.textContent = prob.toFixed(4);
                formula.innerHTML = `P(A) = &int;<sub>A</sub> f(x) dx`;

                chart.innerHTML = drawGaussianSVG(start, end, intervalType === 'point');

                let insightText = "";
                if (intervalType === 'point') {
                    insightText = "<strong>Paradox of Continuous Measure:</strong> A single point {x} has measure 0, yet &Omega; is composed of points and has measure 1. This is why we use &sigma;-algebras of intervals, not arbitrary point sets.";
                } else {
                    insightText = `In a Gaussian space, P([a, b]) = P((a, b)) because the boundary points have zero measure.`;
                }
                insights.innerHTML = `<p class="text-xs leading-relaxed italic text-slate-600">${insightText}</p>`;
            }
        }

        // --- LOGIC HELPERS ---
        function toggleDiscrete(n) {
            if (selectedOutcomes.has(n)) selectedOutcomes.delete(n);
            else selectedOutcomes.add(n);
            updateMeasureTab();
        }

        function setDiscretePreset(type) {
            selectedOutcomes.clear();
            if (type === 'even') [2, 4, 6].forEach(n => selectedOutcomes.add(n));
            if (type === 'prime') [2, 3, 5].forEach(n => selectedOutcomes.add(n));
            updateMeasureTab();
        }

        function setInterval(type, val) {
            const num = parseFloat(val);
            if (type === 'a') intervalA = num;
            else if (type === 'b') intervalB = num;
            else if (type === 'p') { intervalA = num; intervalB = num; }
            updateMeasureTab();
        }

        function setIntervalType(type) {
            intervalType = type;
            if (type === 'point') intervalB = intervalA;
            updateMeasureTab();
        }

        // --- MATH HELPERS ---
        function erf(x) {
            const a1 = 0.254829592, a2 = -0.284496736, a3 = 1.421413741, a4 = -1.453152027, a5 = 1.061405429, p = 0.3275911;
            const sign = (x < 0) ? -1 : 1;
            x = Math.abs(x);
            const t = 1.0 / (1.0 + p * x);
            const y = 1.0 - (((((a5 * t + a4) * t) + a3) * t + a2) * t + a1) * t * Math.exp(-x * x);
            return sign * y;
        }

        function gaussianCDF(x) { return 0.5 * (1 + erf(x / Math.sqrt(2))); }

        function drawGaussianSVG(a, b, isPoint) {
            const w = 500, h = 200, padding = 30;
            const scaleX = (w - 2 * padding) / 8;
            const scaleY = (h - 2 * padding) / 0.4;
            const getX = (val) => padding + (val + 4) * scaleX;
            const getY = (val) => h - padding - ( (1 / Math.sqrt(2 * Math.PI)) * Math.exp(-0.5 * val * val) ) * scaleY;

            let areaPoints = `M ${getX(a)} ${h - padding}`;
            for (let x = a; x <= b; x += 0.05) areaPoints += ` L ${getX(x)} ${getY(x)}`;
            areaPoints += ` L ${getX(b)} ${h - padding} Z`;

            let curvePoints = `M ${getX(-4)} ${getY(-4)}`;
            for (let x = -4; x <= 4; x += 0.1) curvePoints += ` L ${getX(x)} ${getY(x)}`;

            return `
                <svg viewBox="0 0 ${w} ${h}" class="w-full h-auto">
                    ${!isPoint ? `<path d="${areaPoints}" fill="#6366f1" opacity="0.2" />` : ''}
                    ${isPoint ? `<line x1="${getX(a)}" y1="${h-padding}" x2="${getX(a)}" y2="${getY(a)}" stroke="#f43f5e" stroke-width="2" stroke-dasharray="2,2" />` : ''}
                    <path d="${curvePoints}" fill="none" stroke="#4338ca" stroke-width="1.5" />
                    <line x1="${padding}" y1="${h-padding}" x2="${w-padding}" y2="${h-padding}" stroke="#e2e8f0" stroke-width="1" />
                    <text x="${getX(0)}" y="${h-5}" font-size="10" text-anchor="middle" fill="#94a3b8">μ=0</text>
                </svg>
            `;
        }

        // Initialize
        refreshUI();
    </script>
</body>
</html>